"use strict";(globalThis.webpackChunkmon_site=globalThis.webpackChunkmon_site||[]).push([[7527],{8453(e,s,n){n.d(s,{R:()=>a,x:()=>c});var i=n(6540);const r={},l=i.createContext(r);function a(e){const s=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(l.Provider,{value:s},e.children)}},9762(e,s,n){n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>t});const i=JSON.parse('{"id":"fivem/importer-sql","title":"Importer et compresser un fichier SQL","description":"Guide pour g\xe9rer efficacement vos bases de donn\xe9es FiveM, incluant l\'import et la compression de fichiers SQL volumineux.","source":"@site/docs/fivem/importer-sql.md","sourceDirName":"fivem","slug":"/fivem/importer-sql","permalink":"/docs/fivem/importer-sql","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1771977994000,"sidebarPosition":4,"frontMatter":{"title":"Importer et compresser un fichier SQL","sidebar_position":4},"sidebar":"docs","previous":{"title":"Int\xe9grer MySQL avec FiveM","permalink":"/docs/fivem/mysql"},"next":{"title":"Activer OneSync et OneSync Infinity","permalink":"/docs/fivem/onesync-infinity"}}');var r=n(4848),l=n(8453);const a={title:"Importer et compresser un fichier SQL",sidebar_position:4},c=void 0,d={},t=[{value:"Import de fichiers SQL",id:"import-de-fichiers-sql",level:2},{value:"Via phpMyAdmin",id:"via-phpmyadmin",level:3},{value:"Via ligne de commande SSH",id:"via-ligne-de-commande-ssh",level:3},{value:"Import de fichiers multiples",id:"import-de-fichiers-multiples",level:3},{value:"Compression de fichiers SQL",id:"compression-de-fichiers-sql",level:2},{value:"Pourquoi compresser ?",id:"pourquoi-compresser-",level:3},{value:"Compression avec Gzip",id:"compression-avec-gzip",level:3},{value:"Compression avec Bzip2",id:"compression-avec-bzip2",level:3},{value:"Import direct de fichiers compress\xe9s",id:"import-direct-de-fichiers-compress\xe9s",level:3},{value:"Export et compression combin\xe9s",id:"export-et-compression-combin\xe9s",level:2},{value:"Export vers fichier compress\xe9",id:"export-vers-fichier-compress\xe9",level:3},{value:"Export de tables sp\xe9cifiques",id:"export-de-tables-sp\xe9cifiques",level:3},{value:"Augmenter les limites PHP",id:"augmenter-les-limites-php",level:2},{value:"Via php.ini",id:"via-phpini",level:3},{value:"Via .htaccess",id:"via-htaccess",level:3},{value:"Via Plesk",id:"via-plesk",level:3},{value:"Splitting de gros fichiers SQL",id:"splitting-de-gros-fichiers-sql",level:2},{value:"Split en plusieurs fichiers",id:"split-en-plusieurs-fichiers",level:3},{value:"Import des parties",id:"import-des-parties",level:3},{value:"Split &quot;intelligent&quot; (par requ\xeate)",id:"split-intelligent-par-requ\xeate",level:3},{value:"Optimisation de l&#39;import",id:"optimisation-de-limport",level:2},{value:"D\xe9sactiver les checks temporairement",id:"d\xe9sactiver-les-checks-temporairement",level:3},{value:"Configuration MySQL pour import",id:"configuration-mysql-pour-import",level:3},{value:"Import parall\xe8le",id:"import-parall\xe8le",level:3},{value:"Automatisation des backups",id:"automatisation-des-backups",level:2},{value:"Script de backup automatique",id:"script-de-backup-automatique",level:3},{value:"Planifier avec Cron",id:"planifier-avec-cron",level:3},{value:"Backup distant (FTP/SFTP)",id:"backup-distant-ftpsftp",level:3},{value:"V\xe9rification d&#39;int\xe9grit\xe9",id:"v\xe9rification-dint\xe9grit\xe9",level:2},{value:"V\xe9rifier un fichier SQL",id:"v\xe9rifier-un-fichier-sql",level:3},{value:"V\xe9rifier une base apr\xe8s import",id:"v\xe9rifier-une-base-apr\xe8s-import",level:3},{value:"Comparer deux bases",id:"comparer-deux-bases",level:3},{value:"D\xe9pannage",id:"d\xe9pannage",level:2},{value:"&quot;MySQL server has gone away&quot;",id:"mysql-server-has-gone-away",level:3},{value:"&quot;Out of memory&quot;",id:"out-of-memory",level:3},{value:"Import tr\xe8s lent",id:"import-tr\xe8s-lent",level:3},{value:"Fichier corrompu",id:"fichier-corrompu",level:3},{value:"Encodage incorrect",id:"encodage-incorrect",level:3},{value:"Bonnes pratiques",id:"bonnes-pratiques",level:2},{value:"Avant import",id:"avant-import",level:3},{value:"Pendant import",id:"pendant-import",level:3},{value:"Apr\xe8s import",id:"apr\xe8s-import",level:3},{value:"Outils utiles",id:"outils-utiles",level:2},{value:"phpMyAdmin alternatives",id:"phpmyadmin-alternatives",level:3},{value:"Compression outils",id:"compression-outils",level:3},{value:"Ressources",id:"ressources",level:2},{value:"Support",id:"support",level:2}];function o(e){const s={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.p,{children:"Guide pour g\xe9rer efficacement vos bases de donn\xe9es FiveM, incluant l'import et la compression de fichiers SQL volumineux."}),"\n",(0,r.jsx)(s.h2,{id:"import-de-fichiers-sql",children:"Import de fichiers SQL"}),"\n",(0,r.jsx)(s.h3,{id:"via-phpmyadmin",children:"Via phpMyAdmin"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Pour fichiers < 50MB :"})}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["Connectez-vous \xe0 ",(0,r.jsx)(s.strong,{children:"phpMyAdmin"})]}),"\n",(0,r.jsx)(s.li,{children:"S\xe9lectionnez votre base de donn\xe9es"}),"\n",(0,r.jsxs)(s.li,{children:["Onglet ",(0,r.jsx)(s.strong,{children:"Importer"})]}),"\n",(0,r.jsxs)(s.li,{children:["Cliquez ",(0,r.jsx)(s.strong,{children:"Choisir un fichier"})]}),"\n",(0,r.jsxs)(s.li,{children:["S\xe9lectionnez votre ",(0,r.jsx)(s.code,{children:".sql"})]}),"\n",(0,r.jsxs)(s.li,{children:["Format : ",(0,r.jsx)(s.strong,{children:"SQL"})]}),"\n",(0,r.jsxs)(s.li,{children:["Options :","\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"\u2611 Permettre l'interruption"}),"\n",(0,r.jsx)(s.li,{children:"\u2611 Activer la v\xe9rification des cl\xe9s \xe9trang\xe8res"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["Cliquez ",(0,r.jsx)(s.strong,{children:"Ex\xe9cuter"})]}),"\n"]}),"\n",(0,r.jsx)(s.admonition,{title:"Temps d'import",type:"tip",children:(0,r.jsx)(s.p,{children:"Un fichier de 10MB prend environ 30 secondes. Soyez patient !"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Pour fichiers > 50MB :"})}),"\n",(0,r.jsx)(s.p,{children:"La limite d'upload PHP peut bloquer. Utilisez la ligne de commande."}),"\n",(0,r.jsx)(s.h3,{id:"via-ligne-de-commande-ssh",children:"Via ligne de commande SSH"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Import basique :"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"mysql -u utilisateur -p nom_base < fichier.sql\n"})}),"\n",(0,r.jsx)(s.p,{children:"Exemple :"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"mysql -u fivem_user -p'MonMotDePasse123' fivem_server < esx_full.sql\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Import avec progression :"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"pv fichier.sql | mysql -u fivem_user -p nom_base\n"})}),"\n",(0,r.jsxs)(s.p,{children:["Installez ",(0,r.jsx)(s.code,{children:"pv"})," si n\xe9cessaire :"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"apt install pv\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Import de fichiers volumineux :"})}),"\n",(0,r.jsx)(s.p,{children:"Pour fichiers > 1GB, utilisez des options optimis\xe9es :"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"mysql -u fivem_user -p nom_base \\\n  --max_allowed_packet=512M \\\n  --net_buffer_length=16384 \\\n  < huge_database.sql\n"})}),"\n",(0,r.jsx)(s.h3,{id:"import-de-fichiers-multiples",children:"Import de fichiers multiples"}),"\n",(0,r.jsx)(s.p,{children:"Si votre framework a plusieurs fichiers SQL :"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:'# ESX\ncd resources/[esx]/es_extended/sql/\nfor f in *.sql; do\n    mysql -u fivem_user -p fivem_server < "$f"\n    echo "Imported: $f"\ndone\n'})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Ou avec un script :"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:'#!/bin/bash\n# import-all.sh\n\nDB_USER="fivem_user"\nDB_PASS="password"\nDB_NAME="fivem_server"\nSQL_DIR="./sql"\n\nfor file in $SQL_DIR/*.sql; do\n    echo "Importing $file..."\n    mysql -u $DB_USER -p$DB_PASS $DB_NAME < "$file"\n    if [ $? -eq 0 ]; then\n        echo "\u2713 Success: $file"\n    else\n        echo "\u2717 Error: $file"\n    fi\ndone\n\necho "All imports completed!"\n'})}),"\n",(0,r.jsx)(s.p,{children:"Utilisation :"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"chmod +x import-all.sh\n./import-all.sh\n"})}),"\n",(0,r.jsx)(s.h2,{id:"compression-de-fichiers-sql",children:"Compression de fichiers SQL"}),"\n",(0,r.jsx)(s.h3,{id:"pourquoi-compresser-",children:"Pourquoi compresser ?"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Avantages :"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"R\xe9duction de 80-90% de la taille"}),"\n",(0,r.jsx)(s.li,{children:"Transferts plus rapides"}),"\n",(0,r.jsx)(s.li,{children:"\xc9conomie d'espace de stockage"}),"\n",(0,r.jsx)(s.li,{children:"Backups plus l\xe9gers"}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Exemple :"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"database.sql        : 500 MB\ndatabase.sql.gz     : 50 MB  (90% de r\xe9duction)\ndatabase.sql.bz2    : 40 MB  (92% de r\xe9duction)\n"})}),"\n",(0,r.jsx)(s.h3,{id:"compression-avec-gzip",children:"Compression avec Gzip"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Compresser :"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"gzip fichier.sql\n# Cr\xe9e fichier.sql.gz et supprime l'original\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Compresser en gardant l'original :"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"gzip -c fichier.sql > fichier.sql.gz\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Niveau de compression :"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"gzip -9 fichier.sql  # Maximum (plus lent)\ngzip -1 fichier.sql  # Rapide (moins de compression)\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"D\xe9compresser :"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"gunzip fichier.sql.gz\n# Ou\ngzip -d fichier.sql.gz\n"})}),"\n",(0,r.jsx)(s.h3,{id:"compression-avec-bzip2",children:"Compression avec Bzip2"}),"\n",(0,r.jsx)(s.p,{children:"Meilleure compression mais plus lent :"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# Compresser\nbzip2 fichier.sql\n\n# D\xe9compresser\nbunzip2 fichier.sql.bz2\n"})}),"\n",(0,r.jsx)(s.h3,{id:"import-direct-de-fichiers-compress\xe9s",children:"Import direct de fichiers compress\xe9s"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Gzip :"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"zcat fichier.sql.gz | mysql -u user -p database\n"})}),"\n",(0,r.jsx)(s.p,{children:"Ou :"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"gunzip < fichier.sql.gz | mysql -u user -p database\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Bzip2 :"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"bzcat fichier.sql.bz2 | mysql -u user -p database\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Avec progression :"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"pv fichier.sql.gz | gunzip | mysql -u user -p database\n"})}),"\n",(0,r.jsx)(s.h2,{id:"export-et-compression-combin\xe9s",children:"Export et compression combin\xe9s"}),"\n",(0,r.jsx)(s.h3,{id:"export-vers-fichier-compress\xe9",children:"Export vers fichier compress\xe9"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Export standard :"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"mysqldump -u user -p database > backup.sql\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Export + compression Gzip :"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"mysqldump -u user -p database | gzip > backup.sql.gz\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Export + compression Bzip2 :"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"mysqldump -u user -p database | bzip2 > backup.sql.bz2\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Export avec options optimis\xe9es :"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"mysqldump -u fivem_user -p fivem_server \\\n  --single-transaction \\\n  --quick \\\n  --lock-tables=false \\\n  --routines \\\n  --triggers \\\n  --events \\\n  | gzip > backup_$(date +%Y%m%d).sql.gz\n"})}),"\n",(0,r.jsx)(s.h3,{id:"export-de-tables-sp\xe9cifiques",children:"Export de tables sp\xe9cifiques"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# Une seule table\nmysqldump -u user -p database table_name | gzip > table.sql.gz\n\n# Plusieurs tables\nmysqldump -u user -p database table1 table2 table3 | gzip > tables.sql.gz\n\n# Exclure certaines tables\nmysqldump -u user -p database \\\n  --ignore-table=database.logs \\\n  --ignore-table=database.cache \\\n  | gzip > backup_no_logs.sql.gz\n"})}),"\n",(0,r.jsx)(s.h2,{id:"augmenter-les-limites-php",children:"Augmenter les limites PHP"}),"\n",(0,r.jsx)(s.p,{children:"Si vous devez utiliser phpMyAdmin pour de gros fichiers :"}),"\n",(0,r.jsx)(s.h3,{id:"via-phpini",children:"Via php.ini"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-ini",children:"upload_max_filesize = 500M\npost_max_size = 500M\nmax_execution_time = 600\nmax_input_time = 600\nmemory_limit = 512M\n"})}),"\n",(0,r.jsx)(s.p,{children:"Red\xe9marrez PHP-FPM :"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"systemctl restart php8.1-fpm\n"})}),"\n",(0,r.jsx)(s.h3,{id:"via-htaccess",children:"Via .htaccess"}),"\n",(0,r.jsx)(s.p,{children:"Pour un dossier sp\xe9cifique :"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-apache",children:"php_value upload_max_filesize 500M\nphp_value post_max_size 500M\nphp_value max_execution_time 600\nphp_value max_input_time 600\nphp_value memory_limit 512M\n"})}),"\n",(0,r.jsx)(s.h3,{id:"via-plesk",children:"Via Plesk"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Domaines"})," > Votre domaine"]}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.strong,{children:"Param\xe8tres PHP"})}),"\n",(0,r.jsx)(s.li,{children:"Modifiez les valeurs"}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.strong,{children:"OK"})}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"splitting-de-gros-fichiers-sql",children:"Splitting de gros fichiers SQL"}),"\n",(0,r.jsx)(s.p,{children:"Si votre fichier est vraiment \xe9norme (> 2GB) :"}),"\n",(0,r.jsx)(s.h3,{id:"split-en-plusieurs-fichiers",children:"Split en plusieurs fichiers"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# D\xe9couper en fichiers de 100MB\nsplit -b 100M huge.sql huge_part_\n\n# R\xe9sultat :\n# huge_part_aa\n# huge_part_ab\n# huge_part_ac\n"})}),"\n",(0,r.jsx)(s.h3,{id:"import-des-parties",children:"Import des parties"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"cat huge_part_* | mysql -u user -p database\n"})}),"\n",(0,r.jsx)(s.h3,{id:"split-intelligent-par-requ\xeate",children:'Split "intelligent" (par requ\xeate)'}),"\n",(0,r.jsx)(s.p,{children:"Pour \xe9viter de couper au milieu d'une requ\xeate :"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# Utiliser mysqldump avec --extended-insert=FALSE\nmysqldump -u user -p database --extended-insert=FALSE > dump.sql\n\n# Puis split par lignes\nsplit -l 100000 dump.sql part_\n"})}),"\n",(0,r.jsx)(s.h2,{id:"optimisation-de-limport",children:"Optimisation de l'import"}),"\n",(0,r.jsx)(s.h3,{id:"d\xe9sactiver-les-checks-temporairement",children:"D\xe9sactiver les checks temporairement"}),"\n",(0,r.jsxs)(s.p,{children:["Cr\xe9ez un fichier ",(0,r.jsx)(s.code,{children:"optimized_import.sql"})," :"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"SET FOREIGN_KEY_CHECKS=0;\nSET UNIQUE_CHECKS=0;\nSET AUTOCOMMIT=0;\n\nSOURCE /path/to/your/database.sql;\n\nCOMMIT;\nSET FOREIGN_KEY_CHECKS=1;\nSET UNIQUE_CHECKS=1;\nSET AUTOCOMMIT=1;\n"})}),"\n",(0,r.jsx)(s.p,{children:"Import :"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"mysql -u user -p database < optimized_import.sql\n"})}),"\n",(0,r.jsx)(s.h3,{id:"configuration-mysql-pour-import",children:"Configuration MySQL pour import"}),"\n",(0,r.jsxs)(s.p,{children:["Dans ",(0,r.jsx)(s.code,{children:"/etc/mysql/my.cnf"})," :"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-ini",children:"[mysqld]\nmax_allowed_packet=512M\ninnodb_buffer_pool_size=2G\ninnodb_log_file_size=512M\ninnodb_flush_log_at_trx_commit=2\nbulk_insert_buffer_size=256M\n"})}),"\n",(0,r.jsx)(s.p,{children:"Red\xe9marrez MySQL :"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"systemctl restart mysql\n"})}),"\n",(0,r.jsx)(s.h3,{id:"import-parall\xe8le",children:"Import parall\xe8le"}),"\n",(0,r.jsx)(s.p,{children:"Pour bases avec tables ind\xe9pendantes :"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:'# Export chaque table s\xe9par\xe9ment\nfor table in $(mysql -u user -p database -e "SHOW TABLES;" | tail -n +2); do\n    mysqldump -u user -p database $table | gzip > ${table}.sql.gz &\ndone\nwait\n\n# Import parall\xe8le\nfor file in *.sql.gz; do\n    zcat $file | mysql -u user -p database &\ndone\nwait\n'})}),"\n",(0,r.jsx)(s.h2,{id:"automatisation-des-backups",children:"Automatisation des backups"}),"\n",(0,r.jsx)(s.h3,{id:"script-de-backup-automatique",children:"Script de backup automatique"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:'#!/bin/bash\n# auto-backup.sh\n\n# Configuration\nDB_USER="fivem_user"\nDB_PASS="password"\nDB_NAME="fivem_server"\nBACKUP_DIR="/backups/mysql"\nDATE=$(date +%Y%m%d_%H%M%S)\nRETENTION_DAYS=30\n\n# Cr\xe9er dossier si n\'existe pas\nmkdir -p $BACKUP_DIR\n\n# Backup avec compression\nmysqldump -u $DB_USER -p$DB_PASS $DB_NAME \\\n  --single-transaction \\\n  --quick \\\n  --lock-tables=false \\\n  | gzip > $BACKUP_DIR/backup_${DATE}.sql.gz\n\n# V\xe9rifier succ\xe8s\nif [ $? -eq 0 ]; then\n    echo "\u2713 Backup successful: backup_${DATE}.sql.gz"\n    \n    # Taille du backup\n    SIZE=$(du -h $BACKUP_DIR/backup_${DATE}.sql.gz | cut -f1)\n    echo "Size: $SIZE"\n    \n    # Nettoyer anciens backups\n    find $BACKUP_DIR -name "backup_*.sql.gz" -mtime +$RETENTION_DAYS -delete\n    echo "\u2713 Old backups cleaned (>$RETENTION_DAYS days)"\nelse\n    echo "\u2717 Backup failed!"\n    exit 1\nfi\n'})}),"\n",(0,r.jsx)(s.h3,{id:"planifier-avec-cron",children:"Planifier avec Cron"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# \xc9diter crontab\ncrontab -e\n\n# Backup quotidien \xe0 3h du matin\n0 3 * * * /root/auto-backup.sh >> /var/log/mysql-backup.log 2>&1\n\n# Backup toutes les 6 heures\n0 */6 * * * /root/auto-backup.sh >> /var/log/mysql-backup.log 2>&1\n"})}),"\n",(0,r.jsx)(s.h3,{id:"backup-distant-ftpsftp",children:"Backup distant (FTP/SFTP)"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"#!/bin/bash\n# backup-remote.sh\n\n# Backup local\nmysqldump -u user -p database | gzip > /tmp/backup.sql.gz\n\n# Upload SFTP\nsftppass -p password sftp user@remote_host <<EOF\nput /tmp/backup.sql.gz /backups/backup_$(date +%Y%m%d).sql.gz\nbye\nEOF\n\n# Nettoyage\nrm /tmp/backup.sql.gz\n"})}),"\n",(0,r.jsx)(s.h2,{id:"v\xe9rification-dint\xe9grit\xe9",children:"V\xe9rification d'int\xe9grit\xe9"}),"\n",(0,r.jsx)(s.h3,{id:"v\xe9rifier-un-fichier-sql",children:"V\xe9rifier un fichier SQL"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:'# Tester la syntaxe\nmysql -u user -p --force < fichier.sql 2>&1 | grep -i error\n\n# Compter les erreurs\nmysql -u user -p --force < fichier.sql 2>&1 | grep -c "ERROR"\n'})}),"\n",(0,r.jsx)(s.h3,{id:"v\xe9rifier-une-base-apr\xe8s-import",children:"V\xe9rifier une base apr\xe8s import"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"-- Tables manquantes\nSHOW TABLES;\n\n-- Nombre de lignes par table\nSELECT table_name, table_rows \nFROM information_schema.tables \nWHERE table_schema = 'fivem_server';\n\n-- V\xe9rifier int\xe9grit\xe9\nCHECK TABLE nom_table;\n\n-- R\xe9parer si n\xe9cessaire\nREPAIR TABLE nom_table;\n"})}),"\n",(0,r.jsx)(s.h3,{id:"comparer-deux-bases",children:"Comparer deux bases"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# Export structure seule\nmysqldump -u user -p --no-data db1 > db1_structure.sql\nmysqldump -u user -p --no-data db2 > db2_structure.sql\n\n# Comparer\ndiff db1_structure.sql db2_structure.sql\n"})}),"\n",(0,r.jsx)(s.h2,{id:"d\xe9pannage",children:"D\xe9pannage"}),"\n",(0,r.jsx)(s.h3,{id:"mysql-server-has-gone-away",children:'"MySQL server has gone away"'}),"\n",(0,r.jsx)(s.p,{children:"Import trop long, connexion perdue."}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Solutions :"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"SET GLOBAL max_allowed_packet=512M;\nSET GLOBAL wait_timeout=600;\nSET GLOBAL interactive_timeout=600;\n"})}),"\n",(0,r.jsx)(s.h3,{id:"out-of-memory",children:'"Out of memory"'}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Solutions :"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# Augmenter limite PHP\nphp -d memory_limit=2G script.php\n\n# Ou configurer MySQL\ninnodb_buffer_pool_size=4G\n"})}),"\n",(0,r.jsx)(s.h3,{id:"import-tr\xe8s-lent",children:"Import tr\xe8s lent"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Optimisations :"})}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsx)(s.li,{children:"D\xe9sactivez FOREIGN_KEY_CHECKS"}),"\n",(0,r.jsx)(s.li,{children:"Utilisez --quick avec mysqldump"}),"\n",(0,r.jsx)(s.li,{children:"Importez en dehors des heures de pointe"}),"\n",(0,r.jsx)(s.li,{children:"Augmentez innodb_buffer_pool_size"}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"fichier-corrompu",children:"Fichier corrompu"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# Tester int\xe9grit\xe9 archive gzip\ngzip -t fichier.sql.gz\n\n# Si corrompu, essayer r\xe9cup\xe9ration\ngzrecover fichier.sql.gz\n"})}),"\n",(0,r.jsx)(s.h3,{id:"encodage-incorrect",children:"Encodage incorrect"}),"\n",(0,r.jsx)(s.p,{children:"Si caract\xe8res bizarres apr\xe8s import :"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"-- V\xe9rifier encodage\nSHOW VARIABLES LIKE 'character_set%';\n\n-- Convertir table\nALTER TABLE nom_table CONVERT TO CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;\n\n-- Import avec encodage forc\xe9\nmysql -u user -p --default-character-set=utf8mb4 database < fichier.sql\n"})}),"\n",(0,r.jsx)(s.h2,{id:"bonnes-pratiques",children:"Bonnes pratiques"}),"\n",(0,r.jsx)(s.h3,{id:"avant-import",children:"Avant import"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\u2705 ",(0,r.jsx)(s.strong,{children:"Backup"})," de la base actuelle"]}),"\n",(0,r.jsxs)(s.li,{children:["\u2705 V\xe9rifier ",(0,r.jsx)(s.strong,{children:"espace disque"})," suffisant"]}),"\n",(0,r.jsxs)(s.li,{children:["\u2705 Tester sur une ",(0,r.jsx)(s.strong,{children:"base de test"})," d'abord"]}),"\n",(0,r.jsx)(s.li,{children:"\u2705 Lire le fichier SQL pour comprendre le contenu"}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"pendant-import",children:"Pendant import"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\u2705 Surveiller les ",(0,r.jsx)(s.strong,{children:"logs d'erreur"})]}),"\n",(0,r.jsxs)(s.li,{children:["\u2705 V\xe9rifier utilisation ",(0,r.jsx)(s.strong,{children:"RAM/CPU"})]}),"\n",(0,r.jsx)(s.li,{children:"\u2705 Ne pas interrompre sauf erreur critique"}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"apr\xe8s-import",children:"Apr\xe8s import"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\u2705 V\xe9rifier ",(0,r.jsx)(s.strong,{children:"tables cr\xe9\xe9es"})]}),"\n",(0,r.jsxs)(s.li,{children:["\u2705 Compter les ",(0,r.jsx)(s.strong,{children:"lignes"})," import\xe9es"]}),"\n",(0,r.jsxs)(s.li,{children:["\u2705 Tester ",(0,r.jsx)(s.strong,{children:"requ\xeates"})," de base"]}),"\n",(0,r.jsxs)(s.li,{children:["\u2705 V\xe9rifier ",(0,r.jsx)(s.strong,{children:"performances"})]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"outils-utiles",children:"Outils utiles"}),"\n",(0,r.jsx)(s.h3,{id:"phpmyadmin-alternatives",children:"phpMyAdmin alternatives"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Adminer"})," : Plus l\xe9ger, un seul fichier PHP"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"HeidiSQL"})," : Client Windows puissant"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"DBeaver"})," : Multiplateforme, tr\xe8s complet"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"MySQL Workbench"})," : Officiel MySQL"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"compression-outils",children:"Compression outils"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# Installer outils\napt install gzip bzip2 xz-utils pv pigz\n\n# pigz = gzip parall\xe8le (plus rapide)\npigz fichier.sql\nunpigz fichier.sql.gz\n"})}),"\n",(0,r.jsx)(s.h2,{id:"ressources",children:"Ressources"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"https://dev.mysql.com/doc/",children:"MySQL Documentation"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"https://dev.mysql.com/doc/refman/8.0/en/mysqldump.html",children:"mysqldump Manual"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"https://docs.phpmyadmin.net/",children:"phpMyAdmin Docs"})}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"support",children:"Support"}),"\n",(0,r.jsxs)(s.p,{children:["Probl\xe8me avec votre base de donn\xe9es ? ",(0,r.jsx)(s.a,{href:"https://discord.gg/UaHNnMarQA",children:"Discord LKL Cloud"})]})]})}function p(e={}){const{wrapper:s}={...(0,l.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}}}]);