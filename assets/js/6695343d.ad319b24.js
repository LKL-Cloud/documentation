"use strict";(globalThis.webpackChunkmon_site=globalThis.webpackChunkmon_site||[]).push([[5401],{3182(e,n,s){s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>a,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"tuto-vps/installer-docker","title":"Installer Docker & Docker Compose","description":"Guide complet pour installer et utiliser Docker sur votre VPS Linux.","source":"@site/docs/tuto-vps/installer-docker.md","sourceDirName":"tuto-vps","slug":"/tuto-vps/installer-docker","permalink":"/docs/tuto-vps/installer-docker","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1771976669000,"frontMatter":{"title":"Installer Docker & Docker Compose"},"sidebar":"docs","previous":{"title":"Installer Plesk","permalink":"/docs/tuto-vps/installer-plesk"},"next":{"title":"Configurer un Reverse Proxy","permalink":"/docs/tuto-vps/configurer-reverse-proxy"}}');var o=s(4848),i=s(8453);const a={title:"Installer Docker & Docker Compose"},l=void 0,c={},d=[{value:"Installation Docker",id:"installation-docker",level:2},{value:"M\xe9thode automatique (Script officiel)",id:"m\xe9thode-automatique-script-officiel",level:3},{value:"M\xe9thode manuelle (Ubuntu/Debian)",id:"m\xe9thode-manuelle-ubuntudebian",level:3},{value:"Configuration post-installation",id:"configuration-post-installation",level:3},{value:"Installation Docker Compose",id:"installation-docker-compose",level:2},{value:"Version standalone (Recommand\xe9)",id:"version-standalone-recommand\xe9",level:3},{value:"Via plugin Docker",id:"via-plugin-docker",level:3},{value:"Concepts de base",id:"concepts-de-base",level:2},{value:"Images vs Containers",id:"images-vs-containers",level:3},{value:"Dockerfile",id:"dockerfile",level:3},{value:"Docker Compose",id:"docker-compose",level:3},{value:"Commandes Docker essentielles",id:"commandes-docker-essentielles",level:2},{value:"Gestion images",id:"gestion-images",level:3},{value:"Gestion containers",id:"gestion-containers",level:3},{value:"Logs et debugging",id:"logs-et-debugging",level:3},{value:"Volumes et donn\xe9es",id:"volumes-et-donn\xe9es",level:3},{value:"R\xe9seaux",id:"r\xe9seaux",level:3},{value:"Exemples pratiques",id:"exemples-pratiques",level:2},{value:"Nginx reverse proxy",id:"nginx-reverse-proxy",level:3},{value:"Application Node.js",id:"application-nodejs",level:3},{value:"WordPress avec MySQL",id:"wordpress-avec-mysql",level:3},{value:"PostgreSQL + pgAdmin",id:"postgresql--pgadmin",level:3},{value:"Docker Compose commandes",id:"docker-compose-commandes",level:2},{value:"Portainer - Interface graphique",id:"portainer---interface-graphique",level:2},{value:"S\xe9curit\xe9 Docker",id:"s\xe9curit\xe9-docker",level:2},{value:"Limiter ressources",id:"limiter-ressources",level:3},{value:"Utilisateurs non-root",id:"utilisateurs-non-root",level:3},{value:"Secrets",id:"secrets",level:3},{value:"Scan vuln\xe9rabilit\xe9s",id:"scan-vuln\xe9rabilit\xe9s",level:3},{value:"Optimisation",id:"optimisation",level:2},{value:"R\xe9duire taille images",id:"r\xe9duire-taille-images",level:3},{value:".dockerignore",id:"dockerignore",level:3},{value:"Layer caching",id:"layer-caching",level:3},{value:"Backup et restauration",id:"backup-et-restauration",level:2},{value:"Backup container",id:"backup-container",level:3},{value:"Backup volumes",id:"backup-volumes",level:3},{value:"Maintenance",id:"maintenance",level:2},{value:"Nettoyage",id:"nettoyage",level:3},{value:"Updates",id:"updates",level:3},{value:"D\xe9pannage",id:"d\xe9pannage",level:2},{value:"Container s&#39;arr\xeate imm\xe9diatement",id:"container-sarr\xeate-imm\xe9diatement",level:3},{value:"&quot;Cannot connect to Docker daemon&quot;",id:"cannot-connect-to-docker-daemon",level:3},{value:"Port d\xe9j\xe0 utilis\xe9",id:"port-d\xe9j\xe0-utilis\xe9",level:3},{value:"Espace disque plein",id:"espace-disque-plein",level:3},{value:"Ressources",id:"ressources",level:2},{value:"Support",id:"support",level:2}];function t(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.p,{children:"Guide complet pour installer et utiliser Docker sur votre VPS Linux."}),"\n",(0,o.jsx)(n.h2,{id:"installation-docker",children:"Installation Docker"}),"\n",(0,o.jsx)(n.h3,{id:"m\xe9thode-automatique-script-officiel",children:"M\xe9thode automatique (Script officiel)"}),"\n",(0,o.jsx)(n.p,{children:"La m\xe9thode la plus simple et recommand\xe9e."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# T\xe9l\xe9charger et ex\xe9cuter script d'installation\ncurl -fsSL https://get.docker.com -o get-docker.sh\nsudo sh get-docker.sh\n\n# V\xe9rifier installation\ndocker --version\n"})}),"\n",(0,o.jsx)(n.h3,{id:"m\xe9thode-manuelle-ubuntudebian",children:"M\xe9thode manuelle (Ubuntu/Debian)"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"1. Pr\xe9requis :"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"sudo apt update\nsudo apt install apt-transport-https ca-certificates curl gnupg lsb-release -y\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"2. Ajouter cl\xe9 GPG Docker :"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"3. Ajouter repository :"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null\n'})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"4. Installer Docker :"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"sudo apt update\nsudo apt install docker-ce docker-ce-cli containerd.io -y\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"5. V\xe9rifier :"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"sudo docker run hello-world\n"})}),"\n",(0,o.jsx)(n.h3,{id:"configuration-post-installation",children:"Configuration post-installation"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Permettre utilisation sans sudo :"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Ajouter utilisateur au groupe docker\nsudo usermod -aG docker $USER\n\n# Appliquer changements\nnewgrp docker\n\n# Tester\ndocker run hello-world\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"D\xe9marrage automatique :"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"sudo systemctl enable docker\nsudo systemctl start docker\n"})}),"\n",(0,o.jsx)(n.h2,{id:"installation-docker-compose",children:"Installation Docker Compose"}),"\n",(0,o.jsx)(n.h3,{id:"version-standalone-recommand\xe9",children:"Version standalone (Recommand\xe9)"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'# T\xe9l\xe9charger derni\xe8re version\nsudo curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose\n\n# Rendre ex\xe9cutable\nsudo chmod +x /usr/local/bin/docker-compose\n\n# V\xe9rifier\ndocker-compose --version\n'})}),"\n",(0,o.jsx)(n.h3,{id:"via-plugin-docker",children:"Via plugin Docker"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"sudo apt install docker-compose-plugin\ndocker compose version\n"})}),"\n",(0,o.jsx)(n.h2,{id:"concepts-de-base",children:"Concepts de base"}),"\n",(0,o.jsx)(n.h3,{id:"images-vs-containers",children:"Images vs Containers"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Image :"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Template read-only"}),"\n",(0,o.jsx)(n.li,{children:"Contient application + d\xe9pendances"}),"\n",(0,o.jsx)(n.li,{children:"Stock\xe9e dans registry (Docker Hub)"}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Container :"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Instance ex\xe9cutable d'une image"}),"\n",(0,o.jsx)(n.li,{children:"Isol\xe9 et l\xe9ger"}),"\n",(0,o.jsx)(n.li,{children:"Peut \xeatre d\xe9marr\xe9/arr\xeat\xe9"}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"dockerfile",children:"Dockerfile"}),"\n",(0,o.jsx)(n.p,{children:"Fichier d\xe9finissant comment construire une image."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Exemple simple :"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dockerfile",children:'FROM node:20-alpine\n\nWORKDIR /app\n\nCOPY package*.json ./\nRUN npm install\n\nCOPY . .\n\nEXPOSE 3000\n\nCMD ["node", "index.js"]\n'})}),"\n",(0,o.jsx)(n.h3,{id:"docker-compose",children:"Docker Compose"}),"\n",(0,o.jsx)(n.p,{children:"Orchestration de plusieurs containers."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"docker-compose.yml exemple :"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"version: '3.8'\n\nservices:\n  web:\n    build: .\n    ports:\n      - \"3000:3000\"\n    environment:\n      - NODE_ENV=production\n    depends_on:\n      - db\n    \n  db:\n    image: mysql:8\n    environment:\n      MYSQL_ROOT_PASSWORD: password\n      MYSQL_DATABASE: myapp\n    volumes:\n      - db_data:/var/lib/mysql\n\nvolumes:\n  db_data:\n"})}),"\n",(0,o.jsx)(n.h2,{id:"commandes-docker-essentielles",children:"Commandes Docker essentielles"}),"\n",(0,o.jsx)(n.h3,{id:"gestion-images",children:"Gestion images"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Lister images\ndocker images\n\n# T\xe9l\xe9charger image\ndocker pull nginx:latest\n\n# Construire image depuis Dockerfile\ndocker build -t mon-app:1.0 .\n\n# Supprimer image\ndocker rmi nginx:latest\n\n# Nettoyer images non utilis\xe9es\ndocker image prune -a\n"})}),"\n",(0,o.jsx)(n.h3,{id:"gestion-containers",children:"Gestion containers"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Lister containers actifs\ndocker ps\n\n# Lister tous les containers\ndocker ps -a\n\n# D\xe9marrer container\ndocker run -d --name mon-container nginx\n\n# Arr\xeater container\ndocker stop mon-container\n\n# Red\xe9marrer\ndocker restart mon-container\n\n# Supprimer container\ndocker rm mon-container\n\n# Supprimer container en cours\ndocker rm -f mon-container\n\n# Nettoyer containers arr\xeat\xe9s\ndocker container prune\n"})}),"\n",(0,o.jsx)(n.h3,{id:"logs-et-debugging",children:"Logs et debugging"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Voir logs\ndocker logs mon-container\n\n# Logs en temps r\xe9el\ndocker logs -f mon-container\n\n# Derni\xe8res 100 lignes\ndocker logs --tail 100 mon-container\n\n# Ex\xe9cuter commande dans container\ndocker exec -it mon-container bash\n\n# Inspecter container\ndocker inspect mon-container\n\n# Stats ressources\ndocker stats\n"})}),"\n",(0,o.jsx)(n.h3,{id:"volumes-et-donn\xe9es",children:"Volumes et donn\xe9es"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Cr\xe9er volume\ndocker volume create mon-volume\n\n# Lister volumes\ndocker volume ls\n\n# Inspecter volume\ndocker volume inspect mon-volume\n\n# Supprimer volume\ndocker volume rm mon-volume\n\n# Nettoyer volumes non utilis\xe9s\ndocker volume prune\n"})}),"\n",(0,o.jsx)(n.h3,{id:"r\xe9seaux",children:"R\xe9seaux"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Lister r\xe9seaux\ndocker network ls\n\n# Cr\xe9er r\xe9seau\ndocker network create mon-reseau\n\n# Connecter container au r\xe9seau\ndocker network connect mon-reseau mon-container\n\n# Inspecter r\xe9seau\ndocker network inspect mon-reseau\n"})}),"\n",(0,o.jsx)(n.h2,{id:"exemples-pratiques",children:"Exemples pratiques"}),"\n",(0,o.jsx)(n.h3,{id:"nginx-reverse-proxy",children:"Nginx reverse proxy"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"docker-compose.yml :"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:'version: \'3.8\'\n\nservices:\n  nginx:\n    image: nginx:alpine\n    ports:\n      - "80:80"\n      - "443:443"\n    volumes:\n      - ./nginx.conf:/etc/nginx/nginx.conf:ro\n      - ./ssl:/etc/nginx/ssl:ro\n      - ./html:/usr/share/nginx/html:ro\n    restart: unless-stopped\n'})}),"\n",(0,o.jsx)(n.h3,{id:"application-nodejs",children:"Application Node.js"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Dockerfile :"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dockerfile",children:'FROM node:20-alpine\n\nWORKDIR /app\n\n# Copier package.json\nCOPY package*.json ./\n\n# Installer d\xe9pendances\nRUN npm ci --only=production\n\n# Copier code source\nCOPY . .\n\n# Exposer port\nEXPOSE 3000\n\n# Utilisateur non-root\nUSER node\n\n# D\xe9marrer app\nCMD ["node", "server.js"]\n'})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"docker-compose.yml :"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"version: '3.8'\n\nservices:\n  app:\n    build: .\n    ports:\n      - \"3000:3000\"\n    environment:\n      - NODE_ENV=production\n      - DATABASE_URL=mysql://user:pass@db:3306/mydb\n    volumes:\n      - ./logs:/app/logs\n    depends_on:\n      - db\n    restart: unless-stopped\n  \n  db:\n    image: mysql:8\n    environment:\n      MYSQL_ROOT_PASSWORD: rootpassword\n      MYSQL_DATABASE: mydb\n      MYSQL_USER: user\n      MYSQL_PASSWORD: pass\n    volumes:\n      - mysql_data:/var/lib/mysql\n    restart: unless-stopped\n\nvolumes:\n  mysql_data:\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"D\xe9ployer :"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"docker-compose up -d\n"})}),"\n",(0,o.jsx)(n.h3,{id:"wordpress-avec-mysql",children:"WordPress avec MySQL"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"version: '3.8'\n\nservices:\n  wordpress:\n    image: wordpress:latest\n    ports:\n      - \"8080:80\"\n    environment:\n      WORDPRESS_DB_HOST: db:3306\n      WORDPRESS_DB_USER: wordpress\n      WORDPRESS_DB_PASSWORD: wordpress_password\n      WORDPRESS_DB_NAME: wordpress\n    volumes:\n      - wp_data:/var/www/html\n    depends_on:\n      - db\n    restart: unless-stopped\n  \n  db:\n    image: mysql:8\n    environment:\n      MYSQL_ROOT_PASSWORD: root_password\n      MYSQL_DATABASE: wordpress\n      MYSQL_USER: wordpress\n      MYSQL_PASSWORD: wordpress_password\n    volumes:\n      - db_data:/var/lib/mysql\n    restart: unless-stopped\n\nvolumes:\n  wp_data:\n  db_data:\n"})}),"\n",(0,o.jsx)(n.h3,{id:"postgresql--pgadmin",children:"PostgreSQL + pgAdmin"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:'version: \'3.8\'\n\nservices:\n  postgres:\n    image: postgres:15\n    environment:\n      POSTGRES_USER: admin\n      POSTGRES_PASSWORD: admin_password\n      POSTGRES_DB: myapp\n    volumes:\n      - postgres_data:/var/lib/postgresql/data\n    ports:\n      - "5432:5432"\n    restart: unless-stopped\n  \n  pgadmin:\n    image: dpage/pgadmin4\n    environment:\n      PGADMIN_DEFAULT_EMAIL: admin@example.com\n      PGADMIN_DEFAULT_PASSWORD: admin_password\n    ports:\n      - "5050:80"\n    depends_on:\n      - postgres\n    restart: unless-stopped\n\nvolumes:\n  postgres_data:\n'})}),"\n",(0,o.jsx)(n.h2,{id:"docker-compose-commandes",children:"Docker Compose commandes"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# D\xe9marrer services\ndocker-compose up -d\n\n# Arr\xeater services\ndocker-compose down\n\n# Arr\xeater et supprimer volumes\ndocker-compose down -v\n\n# Voir logs\ndocker-compose logs\n\n# Logs en temps r\xe9el\ndocker-compose logs -f\n\n# Logs service sp\xe9cifique\ndocker-compose logs -f web\n\n# Reconstruire images\ndocker-compose build\n\n# Rebuild et restart\ndocker-compose up -d --build\n\n# Lister containers\ndocker-compose ps\n\n# Ex\xe9cuter commande\ndocker-compose exec web bash\n\n# Restart service\ndocker-compose restart web\n"})}),"\n",(0,o.jsx)(n.h2,{id:"portainer---interface-graphique",children:"Portainer - Interface graphique"}),"\n",(0,o.jsx)(n.p,{children:"Gestionnaire Docker avec UI web."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Installation :"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"docker volume create portainer_data\n\ndocker run -d \\\n  -p 8000:8000 \\\n  -p 9443:9443 \\\n  --name portainer \\\n  --restart=always \\\n  -v /var/run/docker.sock:/var/run/docker.sock \\\n  -v portainer_data:/data \\\n  portainer/portainer-ce:latest\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Acc\xe8s :"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.code,{children:"https://VOTRE_IP:9443"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Premi\xe8re connexion :"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Cr\xe9ez compte admin"}),"\n",(0,o.jsx)(n.li,{children:"Connectez-vous \xe0 votre environnement Docker local"}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Fonctionnalit\xe9s :"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Gestion containers via UI"}),"\n",(0,o.jsx)(n.li,{children:"Monitoring ressources"}),"\n",(0,o.jsx)(n.li,{children:"Logs graphiques"}),"\n",(0,o.jsx)(n.li,{children:"Templates d'applications"}),"\n",(0,o.jsx)(n.li,{children:"Stacks Docker Compose"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"s\xe9curit\xe9-docker",children:"S\xe9curit\xe9 Docker"}),"\n",(0,o.jsx)(n.h3,{id:"limiter-ressources",children:"Limiter ressources"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'# Limiter CPU et RAM\ndocker run -d \\\n  --cpus=".5" \\\n  --memory="512m" \\\n  --name limited-container \\\n  nginx\n'})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Dans docker-compose.yml :"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"services:\n  web:\n    image: nginx\n    deploy:\n      resources:\n        limits:\n          cpus: '0.5'\n          memory: 512M\n        reservations:\n          cpus: '0.25'\n          memory: 256M\n"})}),"\n",(0,o.jsx)(n.h3,{id:"utilisateurs-non-root",children:"Utilisateurs non-root"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Dockerfile :"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dockerfile",children:'FROM node:20-alpine\n\n# Cr\xe9er utilisateur\nRUN addgroup -g 1001 appgroup && \\\n    adduser -D -u 1001 -G appgroup appuser\n\nWORKDIR /app\nCOPY --chown=appuser:appgroup . .\n\nUSER appuser\n\nCMD ["node", "app.js"]\n'})}),"\n",(0,o.jsx)(n.h3,{id:"secrets",children:"Secrets"}),"\n",(0,o.jsx)(n.p,{children:"Ne jamais hardcoder secrets dans images."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Via environment :"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'docker run -e DB_PASSWORD="$(cat db_password.txt)" mon-app\n'})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Docker secrets (Swarm) :"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'echo "mon_secret" | docker secret create db_password -\n'})}),"\n",(0,o.jsx)(n.h3,{id:"scan-vuln\xe9rabilit\xe9s",children:"Scan vuln\xe9rabilit\xe9s"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Scanner image\ndocker scan mon-image:latest\n\n# Ou avec Trivy\ndocker run aquasec/trivy image mon-image:latest\n"})}),"\n",(0,o.jsx)(n.h2,{id:"optimisation",children:"Optimisation"}),"\n",(0,o.jsx)(n.h3,{id:"r\xe9duire-taille-images",children:"R\xe9duire taille images"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Multi-stage build :"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dockerfile",children:'# Stage 1: Build\nFROM node:20 AS builder\nWORKDIR /app\nCOPY package*.json ./\nRUN npm install\nCOPY . .\nRUN npm run build\n\n# Stage 2: Production\nFROM node:20-alpine\nWORKDIR /app\nCOPY --from=builder /app/dist ./dist\nCOPY --from=builder /app/node_modules ./node_modules\nCMD ["node", "dist/index.js"]\n'})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Utiliser Alpine :"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dockerfile",children:"# Heavy (1GB+)\nFROM node:20\n\n# L\xe9ger (100-200MB)\nFROM node:20-alpine\n"})}),"\n",(0,o.jsx)(n.h3,{id:"dockerignore",children:".dockerignore"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"node_modules/\nnpm-debug.log\n.git\n.env\n*.md\n.vscode/\n"})}),"\n",(0,o.jsx)(n.h3,{id:"layer-caching",children:"Layer caching"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dockerfile",children:"# \u2705 BON - Cache layers\nFROM node:20-alpine\nWORKDIR /app\nCOPY package*.json ./\nRUN npm install\nCOPY . .\n\n# \u274c MAUVAIS - Invalide cache\nFROM node:20-alpine\nWORKDIR /app\nCOPY . .\nRUN npm install\n"})}),"\n",(0,o.jsx)(n.h2,{id:"backup-et-restauration",children:"Backup et restauration"}),"\n",(0,o.jsx)(n.h3,{id:"backup-container",children:"Backup container"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Commit container vers image\ndocker commit mon-container mon-backup:v1\n\n# Sauvegarder image\ndocker save -o backup.tar mon-backup:v1\n\n# Restaurer\ndocker load -i backup.tar\n"})}),"\n",(0,o.jsx)(n.h3,{id:"backup-volumes",children:"Backup volumes"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Cr\xe9er backup volume\ndocker run --rm \\\n  -v mon-volume:/data \\\n  -v $(pwd):/backup \\\n  alpine tar czf /backup/volume-backup.tar.gz /data\n\n# Restaurer\ndocker run --rm \\\n  -v mon-volume:/data \\\n  -v $(pwd):/backup \\\n  alpine tar xzf /backup/volume-backup.tar.gz -C /\n"})}),"\n",(0,o.jsx)(n.h2,{id:"maintenance",children:"Maintenance"}),"\n",(0,o.jsx)(n.h3,{id:"nettoyage",children:"Nettoyage"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Tout nettoyer (containers, images, volumes, networks)\ndocker system prune -a --volumes\n\n# Sans volumes\ndocker system prune -a\n\n# Espaces utilis\xe9\ndocker system df\n"})}),"\n",(0,o.jsx)(n.h3,{id:"updates",children:"Updates"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# Update images\ndocker-compose pull\ndocker-compose up -d\n\n# Ou pour image sp\xe9cifique\ndocker pull nginx:latest\ndocker-compose up -d --no-deps nginx\n"})}),"\n",(0,o.jsx)(n.h2,{id:"d\xe9pannage",children:"D\xe9pannage"}),"\n",(0,o.jsx)(n.h3,{id:"container-sarr\xeate-imm\xe9diatement",children:"Container s'arr\xeate imm\xe9diatement"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"V\xe9rifier logs :"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"docker logs mon-container\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Causes communes :"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Erreur dans CMD/ENTRYPOINT"}),"\n",(0,o.jsx)(n.li,{children:"Ports d\xe9j\xe0 utilis\xe9s"}),"\n",(0,o.jsx)(n.li,{children:"Permissions fichiers"}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"cannot-connect-to-docker-daemon",children:'"Cannot connect to Docker daemon"'}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# V\xe9rifier service\nsudo systemctl status docker\n\n# Red\xe9marrer\nsudo systemctl restart docker\n\n# Permissions\nsudo usermod -aG docker $USER\nnewgrp docker\n"})}),"\n",(0,o.jsx)(n.h3,{id:"port-d\xe9j\xe0-utilis\xe9",children:"Port d\xe9j\xe0 utilis\xe9"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"Error: bind: address already in use\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Solution :"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'# Trouver processus\nsudo lsof -i :PORT\n\n# Changer port dans docker-compose\nports:\n  - "8080:80"  # Au lieu de 80:80\n'})}),"\n",(0,o.jsx)(n.h3,{id:"espace-disque-plein",children:"Espace disque plein"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# V\xe9rifier utilisation\ndocker system df\n\n# Nettoyer\ndocker system prune -a --volumes\n"})}),"\n",(0,o.jsx)(n.h2,{id:"ressources",children:"Ressources"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://docs.docker.com/",children:"Documentation Docker"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://hub.docker.com/",children:"Docker Hub"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://docs.docker.com/compose/",children:"Docker Compose Docs"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://docs.portainer.io/",children:"Portainer Documentation"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://github.com/veggiemonk/awesome-docker",children:"Awesome Docker"})}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"support",children:"Support"}),"\n",(0,o.jsxs)(n.p,{children:["Questions sur Docker ? ",(0,o.jsx)(n.a,{href:"https://discord.gg/UaHNnMarQA",children:"Discord LKL Cloud"})]})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(t,{...e})}):t(e)}},8453(e,n,s){s.d(n,{R:()=>a,x:()=>l});var r=s(6540);const o={},i=r.createContext(o);function a(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);