"use strict";(globalThis.webpackChunkmon_site=globalThis.webpackChunkmon_site||[]).push([[6092],{54(e,n,s){s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>a,default:()=>p,frontMatter:()=>o,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"tuto-vps/installer-nodejs","title":"Installer Node.js & NVM","description":"Guide complet pour installer Node.js sur votre VPS Linux avec diff\xe9rentes m\xe9thodes.","source":"@site/docs/tuto-vps/installer-nodejs.md","sourceDirName":"tuto-vps","slug":"/tuto-vps/installer-nodejs","permalink":"/docs/tuto-vps/installer-nodejs","draft":false,"unlisted":false,"tags":[],"version":"current","lastUpdatedAt":1771975889000,"frontMatter":{"title":"Installer Node.js & NVM"},"sidebar":"docs","previous":{"title":"Se connecter en SSH \xe0 votre serveur","permalink":"/docs/tuto-vps/ssh"},"next":{"title":"Installer Node.js sur votre serveur","permalink":"/docs/tuto-vps/nodejs"}}');var i=s(4848),l=s(8453);const o={title:"Installer Node.js & NVM"},a=void 0,t={},d=[{value:"M\xe9thodes d&#39;installation",id:"m\xe9thodes-dinstallation",level:2},{value:"M\xe9thode 1 : Via NodeSource (Recommand\xe9)",id:"m\xe9thode-1--via-nodesource-recommand\xe9",level:3},{value:"M\xe9thode 2 : Via NVM (Node Version Manager)",id:"m\xe9thode-2--via-nvm-node-version-manager",level:3},{value:"M\xe9thode 3 : Depuis les d\xe9p\xf4ts Ubuntu (Non recommand\xe9)",id:"m\xe9thode-3--depuis-les-d\xe9p\xf4ts-ubuntu-non-recommand\xe9",level:3},{value:"Configuration Node.js",id:"configuration-nodejs",level:2},{value:"Variables d&#39;environnement",id:"variables-denvironnement",level:3},{value:"npm configuration",id:"npm-configuration",level:3},{value:"Installer des packages globalement",id:"installer-des-packages-globalement",level:2},{value:"Packages essentiels",id:"packages-essentiels",level:3},{value:"Permissions globales",id:"permissions-globales",level:3},{value:"Projet Node.js basique",id:"projet-nodejs-basique",level:2},{value:"Initialiser projet",id:"initialiser-projet",level:3},{value:"Cr\xe9er application simple",id:"cr\xe9er-application-simple",level:3},{value:"D\xe9ploiement avec PM2",id:"d\xe9ploiement-avec-pm2",level:2},{value:"Installation PM2",id:"installation-pm2",level:3},{value:"D\xe9marrer application",id:"d\xe9marrer-application",level:3},{value:"Commandes PM2 essentielles",id:"commandes-pm2-essentielles",level:3},{value:"Auto-d\xe9marrage PM2",id:"auto-d\xe9marrage-pm2",level:3},{value:"Reverse Proxy avec Nginx",id:"reverse-proxy-avec-nginx",level:2},{value:"Installer Nginx",id:"installer-nginx",level:3},{value:"Configuration Nginx",id:"configuration-nginx",level:3},{value:"SSL avec Let&#39;s Encrypt",id:"ssl-avec-lets-encrypt",level:3},{value:"Gestion des d\xe9pendances",id:"gestion-des-d\xe9pendances",level:2},{value:"package.json vs package-lock.json",id:"packagejson-vs-package-lockjson",level:3},{value:"Installation d\xe9pendances",id:"installation-d\xe9pendances",level:3},{value:"Audit s\xe9curit\xe9",id:"audit-s\xe9curit\xe9",level:3},{value:"Variables d&#39;environnement",id:"variables-denvironnement-1",level:2},{value:"Fichier .env",id:"fichier-env",level:3},{value:"Monitoring et logs",id:"monitoring-et-logs",level:2},{value:"PM2 Monitoring",id:"pm2-monitoring",level:3},{value:"Winston pour logs",id:"winston-pour-logs",level:3},{value:"Performance",id:"performance",level:2},{value:"Node.js en cluster",id:"nodejs-en-cluster",level:3},{value:"Optimisation m\xe9moire",id:"optimisation-m\xe9moire",level:3},{value:"Mise \xe0 jour Node.js",id:"mise-\xe0-jour-nodejs",level:2},{value:"Avec NodeSource",id:"avec-nodesource",level:3},{value:"Avec NVM",id:"avec-nvm",level:3},{value:"D\xe9pannage",id:"d\xe9pannage",level:2},{value:"&quot;node: command not found&quot;",id:"node-command-not-found",level:3},{value:"Conflits versions",id:"conflits-versions",level:3},{value:"Erreurs permissions",id:"erreurs-permissions",level:3},{value:"Port d\xe9j\xe0 utilis\xe9",id:"port-d\xe9j\xe0-utilis\xe9",level:3},{value:"Best practices",id:"best-practices",level:2},{value:"Structure projet",id:"structure-projet",level:3},{value:"Scripts npm utiles",id:"scripts-npm-utiles",level:3},{value:"Ressources",id:"ressources",level:2},{value:"Support",id:"support",level:2}];function c(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"Guide complet pour installer Node.js sur votre VPS Linux avec diff\xe9rentes m\xe9thodes."}),"\n",(0,i.jsx)(n.h2,{id:"m\xe9thodes-dinstallation",children:"M\xe9thodes d'installation"}),"\n",(0,i.jsx)(n.h3,{id:"m\xe9thode-1--via-nodesource-recommand\xe9",children:"M\xe9thode 1 : Via NodeSource (Recommand\xe9)"}),"\n",(0,i.jsx)(n.p,{children:"La m\xe9thode la plus simple et fiable."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Node.js 20 LTS (Recommand\xe9) :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# T\xe9l\xe9charger et ex\xe9cuter script d'installation\ncurl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -\n\n# Installer Node.js et npm\nsudo apt install -y nodejs\n\n# V\xe9rifier installation\nnode --version\nnpm --version\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Autres versions disponibles :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Node.js 18 LTS\ncurl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -\nsudo apt install -y nodejs\n\n# Node.js 21 (Current)\ncurl -fsSL https://deb.nodesource.com/setup_21.x | sudo -E bash -\nsudo apt install -y nodejs\n"})}),"\n",(0,i.jsx)(n.h3,{id:"m\xe9thode-2--via-nvm-node-version-manager",children:"M\xe9thode 2 : Via NVM (Node Version Manager)"}),"\n",(0,i.jsx)(n.p,{children:"Id\xe9al pour g\xe9rer plusieurs versions de Node.js."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Installation NVM :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# T\xe9l\xe9charger et installer NVM\ncurl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash\n\n# Recharger configuration shell\nsource ~/.bashrc\n# Ou pour zsh\nsource ~/.zshrc\n\n# V\xe9rifier installation\nnvm --version\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Utiliser NVM :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Installer derni\xe8re version LTS\nnvm install --lts\n\n# Installer version sp\xe9cifique\nnvm install 20.10.0\n\n# Lister versions install\xe9es\nnvm list\n\n# Utiliser version sp\xe9cifique\nnvm use 20\n\n# D\xe9finir version par d\xe9faut\nnvm alias default 20\n\n# Afficher version active\nnvm current\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Passer entre versions :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"nvm use 18    # Node 18\nnvm use 20    # Node 20\nnvm use node  # Derni\xe8re version\n"})}),"\n",(0,i.jsx)(n.h3,{id:"m\xe9thode-3--depuis-les-d\xe9p\xf4ts-ubuntu-non-recommand\xe9",children:"M\xe9thode 3 : Depuis les d\xe9p\xf4ts Ubuntu (Non recommand\xe9)"}),"\n",(0,i.jsx)(n.p,{children:"Version souvent obsol\xe8te."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo apt update\nsudo apt install nodejs npm\n"})}),"\n",(0,i.jsx)(n.h2,{id:"configuration-nodejs",children:"Configuration Node.js"}),"\n",(0,i.jsx)(n.h3,{id:"variables-denvironnement",children:"Variables d'environnement"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Ajouter au PATH (si n\xe9cessaire) :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"echo 'export PATH=\"$HOME/.nvm/versions/node/$(nvm current)/bin:$PATH\"' >> ~/.bashrc\nsource ~/.bashrc\n"})}),"\n",(0,i.jsx)(n.h3,{id:"npm-configuration",children:"npm configuration"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Registry par d\xe9faut :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# V\xe9rifier registry\nnpm config get registry\n\n# Utiliser registry officiel\nnpm config set registry https://registry.npmjs.org/\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Cache npm :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Localiser cache\nnpm config get cache\n\n# Nettoyer cache\nnpm cache clean --force\n"})}),"\n",(0,i.jsx)(n.h2,{id:"installer-des-packages-globalement",children:"Installer des packages globalement"}),"\n",(0,i.jsx)(n.h3,{id:"packages-essentiels",children:"Packages essentiels"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"PM2 - Process Manager :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npm install -g pm2\n\n# V\xe9rifier\npm2 --version\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Yarn - Alternative \xe0 npm :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npm install -g yarn\n\n# V\xe9rifier\nyarn --version\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"TypeScript :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npm install -g typescript\n\n# V\xe9rifier\ntsc --version\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Nodemon - Auto-reload :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npm install -g nodemon\n\n# Utilisation\nnodemon app.js\n"})}),"\n",(0,i.jsx)(n.h3,{id:"permissions-globales",children:"Permissions globales"}),"\n",(0,i.jsx)(n.p,{children:"Si erreurs de permissions lors de l'installation globale :"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Changer propri\xe9taire dossier npm global\nmkdir -p ~/.npm-global\nnpm config set prefix '~/.npm-global'\necho 'export PATH=~/.npm-global/bin:$PATH' >> ~/.bashrc\nsource ~/.bashrc\n"})}),"\n",(0,i.jsx)(n.h2,{id:"projet-nodejs-basique",children:"Projet Node.js basique"}),"\n",(0,i.jsx)(n.h3,{id:"initialiser-projet",children:"Initialiser projet"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Cr\xe9er dossier\nmkdir mon-projet\ncd mon-projet\n\n# Initialiser npm\nnpm init -y\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\xc9diter package.json :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "name": "mon-projet",\n  "version": "1.0.0",\n  "description": "Mon application Node.js",\n  "main": "index.js",\n  "scripts": {\n    "start": "node index.js",\n    "dev": "nodemon index.js"\n  },\n  "keywords": [],\n  "author": "Votre Nom",\n  "license": "MIT"\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"cr\xe9er-application-simple",children:"Cr\xe9er application simple"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"index.js :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"const express = require('express');\nconst app = express();\nconst PORT = 3000;\n\napp.get('/', (req, res) => {\n    res.send('Hello World from Node.js!');\n});\n\napp.listen(PORT, () => {\n    console.log(`Server running on http://localhost:${PORT}`);\n});\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Installer d\xe9pendances :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npm install express\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Lancer :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npm start\n"})}),"\n",(0,i.jsx)(n.h2,{id:"d\xe9ploiement-avec-pm2",children:"D\xe9ploiement avec PM2"}),"\n",(0,i.jsx)(n.h3,{id:"installation-pm2",children:"Installation PM2"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npm install -g pm2\n"})}),"\n",(0,i.jsx)(n.h3,{id:"d\xe9marrer-application",children:"D\xe9marrer application"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Basique :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'pm2 start index.js --name "mon-app"\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Avec options :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'pm2 start index.js \\\n  --name "mon-app" \\\n  --watch \\\n  --instances 4 \\\n  --max-memory-restart 300M\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Avec fichier ecosystem :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// ecosystem.config.js\nmodule.exports = {\n  apps: [{\n    name: 'mon-app',\n    script: './index.js',\n    instances: 'max',\n    exec_mode: 'cluster',\n    env: {\n      NODE_ENV: 'production',\n      PORT: 3000\n    },\n    error_file: './logs/err.log',\n    out_file: './logs/out.log',\n    log_date_format: 'YYYY-MM-DD HH:mm:ss Z'\n  }]\n};\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"D\xe9marrer avec ecosystem :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"pm2 start ecosystem.config.js\n"})}),"\n",(0,i.jsx)(n.h3,{id:"commandes-pm2-essentielles",children:"Commandes PM2 essentielles"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Lister processus\npm2 list\n\n# Logs en temps r\xe9el\npm2 logs\n\n# Logs application sp\xe9cifique\npm2 logs mon-app\n\n# Monitoring\npm2 monit\n\n# Red\xe9marrer\npm2 restart mon-app\n\n# Recharger (zero-downtime)\npm2 reload mon-app\n\n# Arr\xeater\npm2 stop mon-app\n\n# Supprimer\npm2 delete mon-app\n\n# Informations d\xe9taill\xe9es\npm2 show mon-app\n"})}),"\n",(0,i.jsx)(n.h3,{id:"auto-d\xe9marrage-pm2",children:"Auto-d\xe9marrage PM2"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# G\xe9n\xe9rer script startup\npm2 startup\n\n# Sauvegarder liste processus\npm2 save\n\n# Les apps red\xe9marreront automatiquement apr\xe8s reboot\n"})}),"\n",(0,i.jsx)(n.h2,{id:"reverse-proxy-avec-nginx",children:"Reverse Proxy avec Nginx"}),"\n",(0,i.jsx)(n.h3,{id:"installer-nginx",children:"Installer Nginx"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo apt install nginx\n"})}),"\n",(0,i.jsx)(n.h3,{id:"configuration-nginx",children:"Configuration Nginx"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Cr\xe9er config :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo nano /etc/nginx/sites-available/mon-app\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Contenu :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-nginx",children:"server {\n    listen 80;\n    server_name votredomaine.com www.votredomaine.com;\n\n    location / {\n        proxy_pass http://localhost:3000;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection 'upgrade';\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        proxy_cache_bypass $http_upgrade;\n    }\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Activer :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo ln -s /etc/nginx/sites-available/mon-app /etc/nginx/sites-enabled/\nsudo nginx -t\nsudo systemctl reload nginx\n"})}),"\n",(0,i.jsx)(n.h3,{id:"ssl-avec-lets-encrypt",children:"SSL avec Let's Encrypt"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Installer Certbot\nsudo apt install certbot python3-certbot-nginx\n\n# Obtenir certificat\nsudo certbot --nginx -d votredomaine.com -d www.votredomaine.com\n\n# Renouvellement automatique d\xe9j\xe0 configur\xe9\n"})}),"\n",(0,i.jsx)(n.h2,{id:"gestion-des-d\xe9pendances",children:"Gestion des d\xe9pendances"}),"\n",(0,i.jsx)(n.h3,{id:"packagejson-vs-package-lockjson",children:"package.json vs package-lock.json"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"package.json :"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"D\xe9pendances d\xe9clar\xe9es"}),"\n",(0,i.jsx)(n.li,{children:"Versions avec ranges (~, ^)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"package-lock.json :"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Versions exactes install\xe9es"}),"\n",(0,i.jsx)(n.li,{children:"Ne pas modifier manuellement"}),"\n",(0,i.jsx)(n.li,{children:"Commiter dans Git"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"installation-d\xe9pendances",children:"Installation d\xe9pendances"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Installer toutes d\xe9pendances\nnpm install\n\n# Installer d\xe9pendance production\nnpm install express\n\n# Installer d\xe9pendance d\xe9veloppement\nnpm install --save-dev nodemon\n\n# Installer version sp\xe9cifique\nnpm install express@4.18.0\n\n# Mettre \xe0 jour d\xe9pendances\nnpm update\n\n# V\xe9rifier d\xe9pendances obsol\xe8tes\nnpm outdated\n"})}),"\n",(0,i.jsx)(n.h3,{id:"audit-s\xe9curit\xe9",children:"Audit s\xe9curit\xe9"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# V\xe9rifier vuln\xe9rabilit\xe9s\nnpm audit\n\n# Corriger automatiquement (attention, peut casser)\nnpm audit fix\n\n# Force fix (breaking changes possibles)\nnpm audit fix --force\n"})}),"\n",(0,i.jsx)(n.h2,{id:"variables-denvironnement-1",children:"Variables d'environnement"}),"\n",(0,i.jsx)(n.h3,{id:"fichier-env",children:"Fichier .env"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Installer dotenv :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npm install dotenv\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Cr\xe9er .env :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-env",children:"PORT=3000\nNODE_ENV=production\nDATABASE_URL=mongodb://localhost:27017/mydb\nAPI_KEY=votre_cle_secrete\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Utiliser dans code :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"require('dotenv').config();\n\nconst PORT = process.env.PORT || 3000;\nconst API_KEY = process.env.API_KEY;\n\nconsole.log(`Port: ${PORT}`);\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"S\xe9curit\xe9 .gitignore :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"node_modules/\n.env\n*.log\n"})}),"\n",(0,i.jsx)(n.h2,{id:"monitoring-et-logs",children:"Monitoring et logs"}),"\n",(0,i.jsx)(n.h3,{id:"pm2-monitoring",children:"PM2 Monitoring"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Dashboard web :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"pm2 install pm2-server-monit\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"PM2 Plus (cloud) :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"pm2 link [secret] [public]\n"})}),"\n",(0,i.jsx)(n.h3,{id:"winston-pour-logs",children:"Winston pour logs"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"npm install winston\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Configuration :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"const winston = require('winston');\n\nconst logger = winston.createLogger({\n  level: 'info',\n  format: winston.format.json(),\n  defaultMeta: { service: 'mon-app' },\n  transports: [\n    new winston.transports.File({ filename: 'error.log', level: 'error' }),\n    new winston.transports.File({ filename: 'combined.log' }),\n  ],\n});\n\nif (process.env.NODE_ENV !== 'production') {\n  logger.add(new winston.transports.Console({\n    format: winston.format.simple(),\n  }));\n}\n\nmodule.exports = logger;\n"})}),"\n",(0,i.jsx)(n.h2,{id:"performance",children:"Performance"}),"\n",(0,i.jsx)(n.h3,{id:"nodejs-en-cluster",children:"Node.js en cluster"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"const cluster = require('cluster');\nconst os = require('os');\nconst express = require('express');\n\nif (cluster.isMaster) {\n  const numCPUs = os.cpus().length;\n  \n  for (let i = 0; i < numCPUs; i++) {\n    cluster.fork();\n  }\n  \n  cluster.on('exit', (worker) => {\n    console.log(`Worker ${worker.process.pid} died`);\n    cluster.fork();\n  });\n} else {\n  const app = express();\n  // Votre application...\n  app.listen(3000);\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"optimisation-m\xe9moire",children:"Optimisation m\xe9moire"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# Augmenter limite m\xe9moire\nnode --max-old-space-size=4096 index.js\n\n# Via PM2\npm2 start index.js --node-args="--max-old-space-size=4096"\n'})}),"\n",(0,i.jsx)(n.h2,{id:"mise-\xe0-jour-nodejs",children:"Mise \xe0 jour Node.js"}),"\n",(0,i.jsx)(n.h3,{id:"avec-nodesource",children:"Avec NodeSource"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Mettre \xe0 jour vers version plus r\xe9cente\ncurl -fsSL https://deb.nodesource.com/setup_21.x | sudo -E bash -\nsudo apt upgrade nodejs\n"})}),"\n",(0,i.jsx)(n.h3,{id:"avec-nvm",children:"Avec NVM"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Installer nouvelle version\nnvm install 21\n\n# Utiliser nouvelle version\nnvm use 21\n\n# D\xe9finir comme d\xe9faut\nnvm alias default 21\n\n# Supprimer ancienne version\nnvm uninstall 18\n"})}),"\n",(0,i.jsx)(n.h2,{id:"d\xe9pannage",children:"D\xe9pannage"}),"\n",(0,i.jsx)(n.h3,{id:"node-command-not-found",children:'"node: command not found"'}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"V\xe9rifier PATH :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"echo $PATH\nwhich node\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Ajouter au PATH :"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'export PATH="/usr/bin:$PATH"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"conflits-versions",children:"Conflits versions"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Avec NVM, lister versions\nnvm list\n\n# D\xe9sinstaller version\nnvm uninstall 18\n\n# Nettoyer cache npm\nnpm cache clean --force\n"})}),"\n",(0,i.jsx)(n.h3,{id:"erreurs-permissions",children:"Erreurs permissions"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Changer propri\xe9taire\nsudo chown -R $USER:$USER ~/.npm\nsudo chown -R $USER:$USER ~/.config\n"})}),"\n",(0,i.jsx)(n.h3,{id:"port-d\xe9j\xe0-utilis\xe9",children:"Port d\xe9j\xe0 utilis\xe9"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Trouver processus\nsudo lsof -i :3000\n\n# Tuer processus\nsudo kill -9 PID\n"})}),"\n",(0,i.jsx)(n.h2,{id:"best-practices",children:"Best practices"}),"\n",(0,i.jsx)(n.h3,{id:"structure-projet",children:"Structure projet"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"mon-projet/\n\u251c\u2500\u2500 node_modules/\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 controllers/\n\u2502   \u251c\u2500\u2500 models/\n\u2502   \u251c\u2500\u2500 routes/\n\u2502   \u2514\u2500\u2500 index.js\n\u251c\u2500\u2500 tests/\n\u251c\u2500\u2500 logs/\n\u251c\u2500\u2500 .env\n\u251c\u2500\u2500 .gitignore\n\u251c\u2500\u2500 package.json\n\u251c\u2500\u2500 package-lock.json\n\u2514\u2500\u2500 README.md\n"})}),"\n",(0,i.jsx)(n.h3,{id:"scripts-npm-utiles",children:"Scripts npm utiles"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "scripts": {\n    "start": "node src/index.js",\n    "dev": "nodemon src/index.js",\n    "test": "jest",\n    "lint": "eslint src/",\n    "build": "tsc",\n    "pm2:start": "pm2 start ecosystem.config.js",\n    "pm2:stop": "pm2 stop all",\n    "pm2:restart": "pm2 restart all"\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"ressources",children:"Ressources"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://nodejs.org/docs/",children:"Node.js Documentation"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.npmjs.com/",children:"npm Documentation"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/nvm-sh/nvm",children:"NVM GitHub"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://pm2.keymetrics.io/",children:"PM2 Documentation"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://expressjs.com/",children:"Express.js Guide"})}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"support",children:"Support"}),"\n",(0,i.jsxs)(n.p,{children:["Questions sur Node.js ? ",(0,i.jsx)(n.a,{href:"https://discord.gg/UaHNnMarQA",children:"Discord LKL Cloud"})]})]})}function p(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453(e,n,s){s.d(n,{R:()=>o,x:()=>a});var r=s(6540);const i={},l=r.createContext(i);function o(e){const n=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(l.Provider,{value:n},e.children)}}}]);